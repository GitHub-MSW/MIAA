<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<!-- dao의 인터페이스 주소 -->
<mapper namespace="com.tech.miaa.dao.InquiryDao">
	<insert id="inquiry_wirte" parameterType="hashMap">
		INSERT INTO USER_INQUIRY_BOARD VALUES(#{userId},BOARD_NUM_SEQ.NEXTVAL,#{inquiry_title},#{inquiry_content},SYSTIMESTAMP,DEFAULT,#{inquiry_file, jdbcType = VARCHAR})
		<!-- 현재 시퀀스 값 가져오기위한 selectKey  -->
		<selectKey keyProperty="board_num" resultType="String" order="AFTER">
       		SELECT BOARD_NUM_SEQ.CURRVAL FROM DUAL
  		</selectKey>
	</insert>
	<!-- 현재 시퀀스 admin_inquiry에 insert -->
	<insert id="admin_inquiry_add">
		INSERT INTO ADMIN_INQUIRY_BOARD(BOARD_NUM) VALUES(#{board_num})
	</insert>
	
	<select id="inquiry_list" resultType="com.tech.miaa.dto.InquiryDto">
		SELECT BOARD_NUM,ROWNUM,BOARD_TITLE,BOARD_REPLY_STATUS,TO_CHAR(BOARD_REGISTRATION_DATE,'YYYY-MM-DD') BOARD_REGISTRATION_DATE FROM USER_INQUIRY_BOARD WHERE USER_ID=#{param1} ORDER BY ROWNUM DESC
	</select>
	<delete id="delete">
		DELETE FROM USER_INQUIRY_BOARD WHERE BOARD_NUM=#{param1} AND USER_ID=#{param2}
	</delete>
	
</mapper>