<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- dao의 인터페이스 주소 -->
<mapper namespace="com.tech.miaa.dao.MypagePostDao">

	<select id="mypage_post_list_page"
		resultType="com.tech.miaa.dto.MypagePostDto">
		SELECT TOTAL_ID,ITEM_ID,NULL AS ANIMAL_ID, LOSTDAY AS DAY,ADDRESS,ITEM_NAME
		AS NAME,UPKIND,USER_ID,FILENAME FROM
		(SELECT TOTAL_ID,ITEM_ID,LOSTDAY,ADDRESS,ITEM_NAME, UPKIND,USER_ID,FILENAME FROM
		ITEM IT LEFT OUTER JOIN (SELECT TOTAL_ID AS TOTAL2,FILENAME FROM
		ITEM_IMG
		WHERE FILE_ID IN(SELECT MIN(FILE_ID) FROM ITEM_IMG)) ITIMG ON
		IT.TOTAL_ID=ITIMG.TOTAL2)
		UNION ALL
		SELECT TOTAL_ID,NULL AS ITEM_ID, ANIMAL_ID,MISSINGDAY AS
		DAY,ADDRESS,ANIMAL_NAME AS NAME,UPKIND,USER_ID,FILENAME FROM
		(SELECT TOTAL_ID,ANIMAL_ID,MISSINGDAY,ADDRESS,ANIMAL_NAME,UPKIND,USER_ID,FILENAME
		FROM ANIMAL AN LEFT OUTER JOIN (SELECT TOTAL_ID AS TOTAL2,FILENAME
		FROM ANIMAL_IMG WHERE FILE_ID IN
		(SELECT MIN(FILE_ID) FROM ANIMAL_IMG)) ANIMG ON AN.TOTAL_ID=ANIMG.TOTAL2)
		WHERE USER_ID=#{param1} ORDER BY TOTAL_ID DESC
	</select>

</mapper>